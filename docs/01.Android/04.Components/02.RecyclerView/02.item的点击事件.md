---
title: itemçš„ç‚¹å‡»äº‹ä»¶
date: 2022-03-06 16:17:52
permalink: /pages/8f75b8/
categories:
  - Android
  - Components
  - RecyclerView
tags:
  - 
---
åœ¨RecyclerViewä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ç±»ä¼¼setOnItemClickListener( )å’ŒsetOnItemLongClickListener ( )çš„æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±å»æ·»åŠ ã€‚å®ç°Itemçš„ç‚¹å‡»äº‹ä»¶æœ‰ä¸‰ç§æ–¹å¼ï¼š

1. itemçš„å¸ƒå±€æ–‡ä»¶æ·»åŠ ç‚¹å‡»äº‹ä»¶
2. åœ¨åˆ›å»º`ItemView`æ—¶æ·»åŠ ç‚¹å‡»ç›‘å¬
3. é€šè¿‡`RecyclerView`å·²æœ‰çš„æ–¹æ³•`addOnItemTouchListener()`å®ç°
4. å½“`ItemView` **attach** `RecyclerView`æ—¶å®ç°

ä»‹ç»å››ç§æ–¹å¼æ¥æ·»åŠ RecyclerView **itemçš„ç‚¹å‡»äº‹ä»¶**ï¼Œç‚¹å‡»æ•ˆæœå¦‚ä¸‹

![item-click01](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203052033373.gif)

> çœ‹è¿™é‡ŒğŸ‘€ itemå†…éƒ¨çš„ç‚¹å‡»äº‹ä»¶

## 1.æ¡ç›®çš„å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ onClickå±æ€§æ¥å®ç°

**1. ä¸ºitemçš„æ ¹å¸ƒå±€æ–‡ä»¶æ·»åŠ clickå±æ€§**

```xml
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:onClick="itemClick"
    android:orientation="vertical">

    <androidx.cardview.widget.CardView
        android:layout_width="match_parent"
        android:layout_height="110dp"
        android:background="#FFFFFF"
        app:cardUseCompatPadding="true">

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="100dp"
            android:layout_gravity="center_vertical">

            <TextView
                android:id="@+id/itemContent"
                android:layout_width="match_parent"
                android:layout_height="120dp"
                android:layout_marginLeft="10dp"
                android:gravity="center"
                android:text="test"
                android:textSize="20sp" />
        </RelativeLayout>

    </androidx.cardview.widget.CardView>

</RelativeLayout>
```

**2. åœ¨Activityä¸­å®ç°ç‚¹å‡»äº‹ä»¶å³å¯**

```kotlin
class MainActivity : AppCompatActivity() {

    private lateinit var binding: ActivityMainBinding

    private var mRecyclerView: RecyclerView? = null
    private var mAdapter: CommonAdapter? = null
    private val mDatas: MutableList<String> = ArrayList()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        initView()
        initData()

        val layoutManager = LinearLayoutManager(this)
        mRecyclerView!!.layoutManager = layoutManager
        mAdapter = CommonAdapter(this)
        mAdapter!!.setData(mDatas)
        mRecyclerView!!.adapter = mAdapter
    }

    /**
     * @param view å°±æ˜¯æˆ‘ä»¬ç‚¹å‡»çš„itemView
     */
    fun itemClick(view: View?) {
        // è·å–itemViewçš„ä½ç½®
        val position = view?.let { mRecyclerView!!.getChildAdapterPosition(it) }
        // val position = viewHolder?.adapterPosition
        val intent = Intent(this@MainActivity, PageActivity::class.java)
        intent.putExtra("itemName", mDatas[position!!])
        startActivity(intent)
    }

    private fun initView() {
        mRecyclerView = findViewById(R.id.recycler_view)
    }

    private fun initData() {
        for (i in 0..100) {
            mDatas.add("AndroidğŸˆğŸˆğŸˆ - 00$i")
        }
    }
}
```

è¿™ç§æ–¹å¼å¤„ç†itemçš„ç‚¹å‡»äº‹ä»¶æå…¶ç®€å•ï¼Œä½†æ˜¯onClickå±æ€§å¿…é¡»åœ¨åŒ…å«è¯¥ç»„ä»¶çš„Activityä¸­å»å®ç°ï¼Œåœ¨Fragmenté‡Œé¢å°±ä¸è¡Œäº†......å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åå°„å»å®ç°ï¼Œä½†æ˜¯è¿™å°±å¤ªéº»çƒ¦äº†

<br>

## 2. åœ¨Adapterä¸­æä¾›å›è°ƒæ¥å®ç°itemçš„ç‚¹å‡»äº‹ä»¶(æœ€å¸¸ç”¨)

åœ¨Activityä¸­

```kotlin
class MainActivity : AppCompatActivity() {

    private lateinit var binding: ActivityMainBinding

    private var mRecyclerView: RecyclerView? = null
    private var mAdapter: CommonAdapter? = null
    private val dataList: MutableList<String> = ArrayList()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        initView()
        initData()

        val layoutManager = LinearLayoutManager(this)
        mRecyclerView!!.layoutManager = layoutManager
        mAdapter = CommonAdapter(this)
        mAdapter!!.setData(dataList)
        mRecyclerView!!.adapter = mAdapter
        // çœŸæ­£å¤„ç†itemç‚¹å‡»äº‹ä»¶
        mAdapter!!.setOnItemClickListener(object : CommonAdapter.OnItemClickListener {
            override fun onItemClick(position: Int) {
                val intent = Intent(this@MainActivity, PageActivity::class.java)
                intent.putExtra("itemName", dataList[position])
                startActivity(intent)
            }
        })
    }

    private fun initView() {
        mRecyclerView = findViewById(R.id.recycler_view)
    }

    private fun initData() {
        for (i in 0..100) {
            dataList.add("AndroidğŸ–ï¸ - 00$i")
        }
    }
}
```

Adapterä¸­

```kotlin
class CommonAdapter(private val mContext: Context) : RecyclerView.Adapter<CommonAdapter.ViewHolder>() {

    private var mList: List<String>? = null
    private val inflater: LayoutInflater = LayoutInflater.from(mContext)

    // å£°æ˜å›è°ƒæ¥å£
    private var onClickListener: OnItemClickListener? = null

    fun setData(list: List<String>?) {
        mList = list
    }

    /**
     * è®¾ç½®å›è°ƒæ¥å£
     * @param clickListener OnItemClickListener?
     */
    fun setOnItemClickListener(clickListener: OnItemClickListener?) {
        onClickListener = clickListener
    }

    /**
     * åˆ›å»ºViewHolderå®ä¾‹
     * @param parent
     * @param viewType
     * @return
     */
    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): ViewHolder {
        val view: View = inflater.inflate(R.layout.list_item_view, null)
        return ViewHolder(view)
    }

    /**
     * å¯¹RecyclerViewå­é¡¹çš„æ•°æ®è¿›è¡Œèµ‹å€¼çš„ï¼Œä¼šåœ¨æ¯ä¸ªå­é¡¹è¢«æ»šåŠ¨åˆ°å±å¹•å†…çš„æ—¶å€™æ‰§è¡Œ
     * @param holder
     * @param position
     */
    override fun onBindViewHolder(holder: CommonAdapter.ViewHolder, position: Int) {
        val itemData = mList!![position]
        holder.textView.text = itemData

        // é€šè¿‡ä¸ºæ¡ç›®è®¾ç½®ç‚¹å‡»äº‹ä»¶è§¦å‘å›è°ƒ
        holder.itemView.setOnClickListener {
            Toast.makeText(mContext, "item click", Toast.LENGTH_SHORT).show()
            onClickListener!!.onItemClick(holder.adapterPosition)
        }
    }

    override fun getItemCount(): Int {
        return if (mList == null) 0 else mList!!.size
    }

    // å®šä¹‰å›è°ƒæ¥å£
    interface OnItemClickListener {
        fun onItemClick(position: Int)
    }

    inner class ViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {
        @JvmField
        var textView: TextView = itemView.findViewById(R.id.itemContent)
    }
}
```

<br>

## 3. é€šè¿‡RecyclerView.addOnItemTouchListenerå»ç›‘å¬

RecyclerViewä¸­æœ‰ä¸€ä¸ªç›‘å¬è§¦æ‘¸äº‹ä»¶æ–¹æ³•ï¼Œè¯¥æ–¹æ³•éœ€è¦ä¸€ä¸ª`OnItemTouchListener `å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥å¤„ç†itemçš„ç‚¹å‡»äº‹ä»¶ã€‚æ­¤æ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ª`OnItemTouchListener`ï¼ŒOnItemTouchListenerä»£ç å¦‚ä¸‹ï¼š

![image-20220305212603626](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203052126778.png)

` `é€šè¿‡æ³¨é‡Šæˆ‘ä»¬å¯çŸ¥,æ­¤æ–¹æ³•æ˜¯åœ¨æ»šåŠ¨äº‹ä»¶ä¹‹å‰è°ƒç”¨ ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ª `OnItemTouchListener`å¯¹è±¡ ã€‚ `OnItemTouchListener`çš„ä»£ç å¦‚ä¸‹ ï¼š

```java
public static interface OnItemTouchListener { 
 
    public boolean onInterceptTouchEvent(RecyclerView rv, MotionEvent e);
 
    public void onTouchEvent(RecyclerView rv, MotionEvent e);
 
    public void onRequestDisallowInterceptTouchEvent(boolean disallowIntercept);
}
```



åŒæ—¶ï¼ŒRecyclerViewè¿˜æä¾›äº†ä¸€ä¸ªå®ç°ç±»`SimpleOnItemTouchListener`ï¼š

![image-20220305212857746](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203052128861.png)

åœ¨è§¦æ‘¸æ¥å£ä¸­ï¼Œå½“è§¦æ‘¸æ—¶ä¼šå›è°ƒä¸€ä¸ªMotionEventå¯¹è±¡ï¼Œé€šè¿‡ä½¿ç”¨`GestureDetectorCompat`æ¥è§£æç”¨æˆ·çš„æ“ä½œã€‚

### 3.1 äº†è§£GestureDetectorçš„å·¥ä½œåŸç†

å¯¹äºè§¦æ‘¸å±ï¼Œå…¶åŸç”Ÿçš„æ¶ˆæ¯æ— éæŒ‰ä¸‹ã€æŠ¬èµ·ã€ç§»åŠ¨è¿™å‡ ç§ï¼Œæˆ‘ä»¬åªéœ€è¦ç®€å•é‡è½½onTouchæˆ–è€…è®¾ç½®è§¦æ‘¸ä¾¦å¬å™¨setOnTouchListenerå³å¯è¿›è¡Œå¤„ç†ã€‚ä¸è¿‡ï¼Œä¸ºäº†æé«˜æˆ‘ä»¬çš„APPçš„ç”¨æˆ·ä½“éªŒï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è¯†åˆ«ç”¨æˆ·çš„æ‰‹åŠ¿ï¼ŒAndroidç»™æˆ‘ä»¬æä¾›çš„æ‰‹åŠ¿è¯†åˆ«å·¥å…·GestureDetectorå°±å¯ä»¥å¸®ä¸Šå¤§å¿™äº†ã€‚

 GestureDetectorçš„å·¥ä½œåŸç†æ˜¯ï¼Œå½“æˆ‘ä»¬æ¥æ”¶åˆ°ç”¨æˆ·è§¦æ‘¸æ¶ˆæ¯æ—¶ï¼Œå°†è¿™ä¸ªæ¶ˆæ¯äº¤ç»™GestureDetectorå»åŠ å·¥ï¼Œæˆ‘ä»¬é€šè¿‡è®¾ç½®ä¾¦å¬å™¨è·å¾—GestureDetectorå¤„ç†åçš„æ‰‹åŠ¿ã€‚

  GestureDetectoræä¾›äº†ä¸¤ä¸ªä¾¦å¬å™¨æ¥å£ï¼ŒOnGestureListenerå¤„ç†å•å‡»ç±»æ¶ˆæ¯ï¼ŒOnDoubleTapListenerå¤„ç†åŒå‡»ç±»æ¶ˆæ¯ã€‚

OnGestureListenerçš„æ¥å£æœ‰è¿™å‡ ä¸ªï¼š

```java
// å•å‡»ï¼Œè§¦æ‘¸å±æŒ‰ä¸‹æ—¶ç«‹åˆ»è§¦å‘  
abstract boolean onDown(MotionEvent e);  

// æŠ¬èµ·ï¼Œæ‰‹æŒ‡ç¦»å¼€è§¦æ‘¸å±æ—¶è§¦å‘(é•¿æŒ‰ã€æ»šåŠ¨ã€æ»‘åŠ¨æ—¶ï¼Œä¸ä¼šè§¦å‘è¿™ä¸ªæ‰‹åŠ¿)  
abstract boolean onSingleTapUp(MotionEvent e);  

// çŸ­æŒ‰ï¼Œè§¦æ‘¸å±æŒ‰ä¸‹åç‰‡åˆ»åæŠ¬èµ·ï¼Œä¼šè§¦å‘è¿™ä¸ªæ‰‹åŠ¿ï¼Œå¦‚æœè¿…é€ŸæŠ¬èµ·åˆ™ä¸ä¼š  
abstract void onShowPress(MotionEvent e);  

// é•¿æŒ‰ï¼Œè§¦æ‘¸å±æŒ‰ä¸‹åæ—¢ä¸æŠ¬èµ·ä¹Ÿä¸ç§»åŠ¨ï¼Œè¿‡ä¸€æ®µæ—¶é—´åè§¦å‘  
abstract void onLongPress(MotionEvent e);  

// æ»šåŠ¨ï¼Œè§¦æ‘¸å±æŒ‰ä¸‹åç§»åŠ¨  
abstract boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY);  

// æ»‘åŠ¨ï¼Œè§¦æ‘¸å±æŒ‰ä¸‹åå¿«é€Ÿç§»åŠ¨å¹¶æŠ¬èµ·ï¼Œä¼šå…ˆè§¦å‘æ»šåŠ¨æ‰‹åŠ¿ï¼Œè·Ÿç€è§¦å‘ä¸€ä¸ªæ»‘åŠ¨æ‰‹åŠ¿  
abstract boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY);  
```
OnDoubleTapListenerçš„æ¥å£æœ‰è¿™å‡ ä¸ªï¼š

```java
    // åŒå‡»ï¼Œæ‰‹æŒ‡åœ¨è§¦æ‘¸å±ä¸Šè¿…é€Ÿç‚¹å‡»ç¬¬äºŒä¸‹æ—¶è§¦å‘  
    abstract boolean onDoubleTap(MotionEvent e);  
    // åŒå‡»çš„æŒ‰ä¸‹è·ŸæŠ¬èµ·å„è§¦å‘ä¸€æ¬¡  
    abstract boolean onDoubleTapEvent(MotionEvent e);  
    // å•å‡»ç¡®è®¤ï¼Œå³å¾ˆå¿«çš„æŒ‰ä¸‹å¹¶æŠ¬èµ·ï¼Œä½†å¹¶ä¸è¿ç»­ç‚¹å‡»ç¬¬äºŒä¸‹  
    abstract boolean onSingleTapConfirmed(MotionEvent e);  
```

æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦å¤„ç†ä¸Šé¢æ‰€æœ‰æ‰‹åŠ¿ï¼Œæ–¹ä¾¿èµ·è§ï¼ŒAndroidæä¾›äº†å¦å¤–ä¸€ä¸ªç±»`SimpleOnGestureListener`å®ç°äº†å¦‚ä¸Šæ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦ç»§æ‰¿SimpleOnGestureListenerç„¶åé‡è½½éœ€è¦çš„æ‰‹åŠ¿å³å¯ã€‚

### 3.2 å®ç°ç‚¹å‡»äº‹ä»¶ç›‘å¬

**1. å®šä¹‰æ¥å£OnItemTouchListener**

äº†è§£Androidäº‹ä»¶åˆ†å‘æœºåˆ¶çš„è‚¯å®šå¯¹è¿™å‡ ä¸ªæ–¹æ³•å¾ˆç†Ÿæ‚‰ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•æ˜¯æ‹¦æˆªè§¦æ‘¸äº‹ä»¶çš„ï¼Œç¬¬äºŒä¸ªæ–¹æ³•æ˜¯å¤„ç†è§¦æ‘¸äº‹ä»¶çš„ï¼Œç¬¬ä¸‰ä¸ªæ–¹æ³•æ˜¯å¤„ç†è§¦æ‘¸å†²çªçš„ã€‚æ­¤æ¥å£å®˜æ–¹æä¾›äº†ä¸€ä¸ªå®ç°ç±»SimpleOnItemTouchListenerï¼Œä¸è¿‡æ²¡æœ‰å¤„ç†ä»€ä¹ˆé€»è¾‘ã€‚

```kotlin
interface OnItemTouchListener {

    /**
     * æ‹¦æˆªè§¦æ‘¸äº‹ä»¶
     * @param rv RecyclerView?
     * @param e MotionEvent?
     * @return Boolean
     */
    fun onInterceptTouchEvent(rv: RecyclerView?, e: MotionEvent?): Boolean

    /**
     * å¤„ç†è§¦æ‘¸äº‹ä»¶
     * @param rv RecyclerView?
     * @param e MotionEvent?
     */
    fun onTouchEvent(rv: RecyclerView?, e: MotionEvent?)

    /**
     * å¤„ç†è§¦æ‘¸å†²çª
     * @param disallowIntercept Boolean
     */
    fun onRequestDisallowInterceptTouchEvent(disallowIntercept: Boolean)
}
```

**2. ç»§æ‰¿OnItemTouchListener**

è¿™é‡Œæˆ‘ä»¬é€šè¿‡ç»§æ‰¿SimpleOnItemTouchListener æ¥å®ç°æˆ‘ä»¬çš„ç‚¹å‡»äº‹ä»¶ã€‚

é¦–å…ˆå†™ä¸€ä¸ªSimpleRecycleViewItemClickListenerç±»ç»§æ‰¿SimpleOnItemTouchListenerï¼Œæ„é€ æ—¶ä¼ å…¥Itemç‚¹å‡»å›è°ƒOnItemClickListenerï¼Œå¹¶è¦†å†™çˆ¶ç±»çš„é‡å†™`onInterceptTouchEvent`æ–¹æ³•ï¼Œåœ¨onInterceptTouchEventä¸­è¿›è¡Œäº‹ä»¶å¤„ç†ï¼›

> æ­¤å¤„æ˜¯ç”¨æŠ½è±¡ç±»æ¥å®ç°ï¼Œæ¥å£å®ç°å‚è€ƒğŸ”—[SimpleItemClickListener](https://github.com/IQQcode/MobileCoding/blob/main/Android-Core/03-Components/RecyclerView/ItemClick/clicktouch02/src/main/java/top/iqqcode/clicktouch02/SimpleItemClickListener.kt)

```java
abstract class ItemClickListener(private val mRecyclerView: RecyclerView) : SimpleOnItemTouchListener() {

    private val mGestureDetectorCompat: GestureDetectorCompat

    /**
     * å°†äº‹ä»¶äº¤ç»™GestureDetectorCompatå¤„ç†
     * å¹¶å°†MotionEvent ä¼ å…¥GestureDetectorCompatä½¿å¾—å¯ä»¥è·å–è§¦æ‘¸çš„åæ ‡
     */
    override fun onTouchEvent(rv: RecyclerView, e: MotionEvent) {
        mGestureDetectorCompat.onTouchEvent(e)
    }

    /**
     * ä¸æ‹¦æˆªè§¦æ‘¸äº‹ä»¶,å°†äº‹ä»¶äº¤ç»™GestureDetectorCompatå¤„ç†
     * @param rv RecyclerView
     * @param e MotionEvent
     * @return Boolean
     */
    override fun onInterceptTouchEvent(rv: RecyclerView, e: MotionEvent): Boolean {
        mGestureDetectorCompat.onTouchEvent(e)
        return false
    }

    override fun onRequestDisallowInterceptTouchEvent(disallowIntercept: Boolean) {}

    /**
     * å®šä¹‰ä¸€ä¸ªæŠ½è±¡å›è°ƒæ–¹æ³•
     * @param vh ViewHolder?
     */
    abstract fun onItemClick(vh: RecyclerView.ViewHolder?)

    abstract fun onItemLongClick(vh: RecyclerView.ViewHolder?)

    abstract fun onItemDoubleClick(vh: View?)

    private inner class MyGestureListener : SimpleOnGestureListener() {

        override fun onSingleTapUp(e: MotionEvent?): Boolean {
            val childView = e?.let { mRecyclerView.findChildViewUnder(it.x, e.y) }
            if (childView != null) {
                val viewHolder = mRecyclerView.getChildViewHolder(childView)
                onItemClick(viewHolder) //è§¦å‘å›è°ƒ
            }
            return false
        }

        /**
         * é•¿æŒ‰äº‹ä»¶
         * @param e MotionEvent
         */
        override fun onLongPress(e: MotionEvent?) {
            super.onLongPress(e)
            val childView = e?.let { mRecyclerView.findChildViewUnder(it.x, e.y) }
            if (childView != null) {
                val viewHolder = mRecyclerView.getChildViewHolder(childView)
                onItemLongClick(viewHolder) //è§¦å‘å›è°ƒ
            }
        }

        override fun onDoubleTapEvent(e: MotionEvent?): Boolean {
            val action = e?.action;
            if (action == MotionEvent.ACTION_UP) {
                val childView = e.let { mRecyclerView.findChildViewUnder(it.x, e.y) }
                if (childView != null) {
                    onItemDoubleClick(childView);
                    return true;
                }
            }
            return false
        }
    }

    // é€šè¿‡æ„é€ ä¼ å…¥æˆ‘ä»¬çš„RecyclerView,å¹¶åˆå§‹åŒ–GestureDetectorCompat
    init {
        mGestureDetectorCompat = GestureDetectorCompat(
            mRecyclerView.context, MyGestureListener())
    }
}
```

RecyclerViewæä¾›äº†`findChildViewUnder`æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡äº‹ä»¶ç‚¹å‡»çš„åæ ‡è·å–ç‚¹å‡»çš„Itemï¼Œå†é€šè¿‡RecyclerViewçš„`getChildViewHolder`æ–¹æ³•è·å–Itemçš„ViewHolderï¼Œè¿›è€Œæ‰§è¡Œæˆ‘ä»¬æƒ³è¦çš„æ“ä½œã€‚

åœ¨`GestureDetectorCompat`çš„æ‰‹åŠ¿å›è°ƒä¸­æˆ‘ä»¬è¦†å†™:

1. `boolean onSingleTapUp(MotionEvent e)`å•å‡»æŠ¬èµ·å›è°ƒ
2. `void onLongPress(MotionEvent e)`é•¿æŒ‰å›è°ƒ

<br>

**3. åœ¨Activityä¸­è°ƒç”¨`addOnItemTouchListener()`æ–¹æ³•**

åœ¨`RecyclerView`çš„å¯¹è±¡ä¸­æ·»åŠ `addOnItemTouchListener()`æ–¹æ³•,ç„¶ååœ¨å›è°ƒä¸­å¤„ç†éœ€è¦çš„äº‹ä»¶:

```kotlin
class MainActivity : AppCompatActivity() {

    private lateinit var binding: ActivityMainBinding

    private var mRecyclerView: RecyclerView? = null
    private var mAdapter: CommonAdapter? = null
    private val mDatas: MutableList<String> = ArrayList()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        initView()
        initData()

        val layoutManager = LinearLayoutManager(this)
        mRecyclerView!!.layoutManager = layoutManager
        mAdapter = CommonAdapter(this)
        mAdapter!!.setData(mDatas)
        mRecyclerView!!.adapter = mAdapter

        mRecyclerView!!.addOnItemTouchListener(object : ItemClickListener(mRecyclerView!!) {
            override fun onItemClick(viewHolder: RecyclerView.ViewHolder?) {
                val position = viewHolder?.adapterPosition
                val intent = Intent(this@MainActivity, PageActivity::class.java)
                intent.putExtra("itemName", mDatas[position!!])
                startActivity(intent) // è·³è½¬æ–°Activityï¼Œå°†itemçš„æ•°æ®ä¼ å…¥æ–°Activity
            }
        })
    }

    private fun initView() {
        mRecyclerView = findViewById(R.id.recycler_view)
    }

    private fun initData() {
        for (i in 0..100) {
            mDatas.add("AndroidğŸ–ï¸ - 00$i")
        }
    }
}
```

<br>

## 4. åœ¨Itemæ·»åŠ åˆ°RecyclerViewæ—¶æ·»åŠ ç‚¹å‡»äº‹ä»¶

RecyclerViewè¿˜æä¾›äº†ä¸€ä¸ª`addOnChildAttachStateChangeListener`æ–¹æ³•ï¼Œå¯ä»¥ä¸ºRecyclerViewæä¾›ä¸€ä¸ª`OnChildAttachStateChangeListener`ï¼Œç›‘å¬ä¸€ä¸ªViewæ·»åŠ åˆ°RecyclerViewå’Œç¦»å¼€RecyclerViewï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™æ‰§è¡Œä¸€äº›æ“ä½œæ¥å®ç°Itemç‚¹å‡»ï¼š

```java
OnChildAttachStateChangeListener listener = new RecyclerView.OnChildAttachStateChangeListener() {
    @Override
    public void onChildViewAttachedToWindow(@NonNull View view) {
        final RecyclerView.ViewHolder viewHolder = mRecyclerView.getChildViewHolder(view);
        view.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (mListener != null){
                    mListener.onItemClick(viewHolder);
                }
            }
        });
    }

    @Override
    public void onChildViewDetachedFromWindow(@NonNull View view) {}
}
// ...
mRecyclerView.addOnChildAttachStateChangeListener(listener);
```

**1. è‡ªå®šä¹‰çš„æ¡ç›®ç‚¹å‡»äº‹ä»¶æ”¯æŒç±»ItemClickSupport**

```kotlin
class ItemClickSupport public constructor(private val mRecyclerView: RecyclerView) {

    private var mOnItemClickListener: OnItemClickListener? = null
    private var mOnItemLongClickListener: OnItemLongClickListener? = null

    private val mOnClickListener = View.OnClickListener { v ->
        if (mOnItemClickListener != null) {
            val holder = mRecyclerView.getChildViewHolder(v)
            mOnItemClickListener!!.onItemClicked(mRecyclerView, holder.adapterPosition, v)
        }
    }

    private val mOnLongClickListener = OnLongClickListener { v ->
        if (mOnItemLongClickListener != null) {
            val holder = mRecyclerView.getChildViewHolder(v)
            return@OnLongClickListener mOnItemLongClickListener!!.onItemLongClicked(mRecyclerView,
                holder.adapterPosition, v)
        }
        false
    }

    private val mAttachListener: OnChildAttachStateChangeListener =
        object : OnChildAttachStateChangeListener {
            override fun onChildViewAttachedToWindow(view: View) {
                if (mOnItemClickListener != null) {
                    view.setOnClickListener(mOnClickListener)
                }
                if (mOnItemLongClickListener != null) {
                    view.setOnLongClickListener(mOnLongClickListener)
                }
            }

            override fun onChildViewDetachedFromWindow(view: View) {}
        }

    fun setOnItemClickListener(listener: OnItemClickListener?): ItemClickSupport {
        mOnItemClickListener = listener
        return this
    }

    fun setOnItemLongClickListener(listener: OnItemLongClickListener?): ItemClickSupport {
        mOnItemLongClickListener = listener
        return this
    }

    public fun detach(view: RecyclerView) {
        view.removeOnChildAttachStateChangeListener(mAttachListener)
        view.setTag(R.id.item_click_support, null)
    }

    interface OnItemClickListener {
        fun onItemClicked(recyclerView: RecyclerView?, position: Int, v: View?)
    }

    interface OnItemLongClickListener {
        fun onItemLongClicked(recyclerView: RecyclerView?, position: Int, v: View?): Boolean
    }

    companion object {

        /**
         * ä¸ºRecyclerViewè®¾ç½®ItemClickSupport
         * @param view [ERROR : RecyclerView]
         * @return ItemClickSupport
         */
        fun addTo(view: RecyclerView): ItemClickSupport {
            var support = view.getTag(R.id.item_click_support) as? ItemClickSupport
            if (support == null) {
                support = ItemClickSupport(view)
            }
            return support
        }

        /**
         * ä¸ºRecyclerViewç§»é™¤ItemClickSupport
         * @param view [ERROR : RecyclerView]
         * @return ItemClickSupport?
         */
        fun removeFrom(view: RecyclerView): ItemClickSupport? {
            val support = view.getTag(R.id.item_click_support) as? ItemClickSupport
            support?.detach(view)
            return support
        }
    }

    init {
        mRecyclerView.setTag(R.id.item_click_support, this)
        mRecyclerView.addOnChildAttachStateChangeListener(mAttachListener)
    }
}
```

**2. åœ¨valuesç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªids.xml**

```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <item name="item_click_support" type="id" />
</resources>
```

**3. åœ¨Activityä¸­è°ƒç”¨**

```kotlin
class MainActivity : AppCompatActivity() {

    private lateinit var binding: ActivityMainBinding

    private var mRecyclerView: RecyclerView? = null
    private var mAdapter: CommonAdapter? = null
    private val mDatas: MutableList<String> = ArrayList()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        initView()
        initData()

        val layoutManager = LinearLayoutManager(this)
        mRecyclerView!!.layoutManager = layoutManager
        mAdapter = CommonAdapter(this)
        mAdapter!!.setData(mDatas)
        mRecyclerView!!.adapter = mAdapter


        ItemClickSupport.addTo(mRecyclerView!!).setOnItemClickListener(object : ItemClickSupport.OnItemClickListener {
            override fun onItemClicked(recyclerView: RecyclerView?, position: Int, v: View?) {
                val intent = Intent(this@MainActivity, PageActivity::class.java)
                intent.putExtra("itemName", mDatas[position])
                startActivity(intent)
            }
        })

    }

    private fun initView() {
        mRecyclerView = findViewById(R.id.recycler_view)
    }

    private fun initData() {
        for (i in 0..100) {
            mDatas.add("AndroidğŸ¨ - 00$i")
        }
    }
}
```

<br>

ä»ä»¥ä¸Šä¸‰ç§æ–¹å¼çš„å®ç°è¿‡ç¨‹å¯çŸ¥:

1. ç¬¬ä¸€ç§æ–¹å¼å¯ä»¥å¾ˆæ–¹ä¾¿è·å–ç”¨æˆ·ç‚¹å‡»çš„åæ ‡.
2. ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æ–¹å¼å¯ä»¥å¾ˆæ–¹ä¾¿å¯¹`ItemView`ä¸­çš„å­`View`è¿›è¡Œç›‘å¬.
3. ç¬¬ä¸€ç§æ–¹å¼å’Œç¬¬ä¸‰ç§æ–¹å¼å¯ä»¥å†™åœ¨å•ç‹¬çš„ç±»ä¸­,ç›¸å¯¹äºç¬¬äºŒç§å†™åœ¨`Adapter`çš„æ–¹å¼å¯ä½¿ä»£ç æ›´ç‹¬ç«‹æ•´æ´

ğŸ“¦æœ¬æ–‡ä»£ç Demo[Item Link](https://github.com/IQQcode/MobileCoding/tree/main/Android-Core/03-Components/RecyclerView/ItemClick)

----

**ã€æ–‡ç« å‚è€ƒã€‘**

1. Hugo. Getting your clicks on RecyclerView. https://www.littlerobots.nl/blog/Handle-Android-RecyclerView-Clicks/
2.  [éšé£é£˜æ‰¬çš„smile](https://www.jianshu.com/u/549034def91a).RecyclerViewç³»åˆ—ä¹‹ä¸‰ï¼šå¤„ç†itemçš„ç‚¹å‡»äº‹ä»¶. https://www.jianshu.com/p/971396467a62
3. [DevWiki](https://juejin.cn/user/1081575169340958). ä¸‰ç§æ–¹å¼å®ç° RecyclerView çš„ Item ç‚¹å‡»äº‹ä»¶. https://juejin.cn/post/6844903439655239688

 