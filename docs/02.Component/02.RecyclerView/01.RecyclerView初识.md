---
 title: RecyclerViewåˆè¯†
date: 2022-03-13 19:54:32
permalink: /pages/9eae16/
categories:
  - Component
  - RecyclerView
tags:
  - 
---
## 1. RecyclerBiewç®€ä»‹

### 1.1 RecyclerViewæ˜¯ä»€ä¹ˆ

![img](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121421112.png)

ä»Android 5.0å¼€å§‹ï¼Œè°·æ­Œå…¬å¸æ¨å‡ºäº†ä¸€ä¸ªç”¨äºå¤§é‡æ•°æ®å±•ç¤ºçš„æ–°æ§ä»¶RecylerViewï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿ä¼ ç»Ÿçš„ListViewï¼Œæ›´åŠ å¼ºå¤§å’Œçµæ´»ã€‚å¯ä»¥è¯´ï¼Œæ¯ä¸ªAPPéƒ½å¯ä»¥çœ‹åˆ°RecyclerViewçš„å½±å­ã€‚RecyclerViewçš„å®˜æ–¹å®šä¹‰å¦‚ä¸‹ï¼š

> ä¸€ç§çµæ´»çš„è§†å›¾ï¼Œç”¨äºæä¾›è¿›å…¥å¤§å‹æ•°æ®é›†çš„æœ‰é™çª—å£ã€‚
>
> ä»å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œflexibleï¼ˆå¯æ‰©å±•æ€§ï¼‰æ˜¯RecyclerViewçš„ç‰¹ç‚¹ã€‚

RecyclerView å¯ä»¥è®©æ‚¨è½»æ¾é«˜æ•ˆåœ°æ˜¾ç¤ºå¤§é‡æ•°æ®ã€‚æ‚¨æä¾›æ•°æ®å¹¶å®šä¹‰æ¯ä¸ªåˆ—è¡¨é¡¹çš„å¤–è§‚ï¼Œè€Œ RecyclerView åº“ä¼šæ ¹æ®éœ€è¦åŠ¨æ€åˆ›å»ºå…ƒç´ ã€‚

é¡¾åæ€ä¹‰ï¼ŒRecyclerView ä¼šå›æ”¶è¿™äº›å•ä¸ªçš„å…ƒç´ ã€‚å½“åˆ—è¡¨é¡¹æ»šåŠ¨å‡ºå±å¹•æ—¶ï¼ŒRecyclerView ä¸ä¼šé”€æ¯å…¶è§†å›¾ã€‚ç›¸åï¼ŒRecyclerView ä¼šå¯¹å±å¹•ä¸Šæ»šåŠ¨çš„æ–°åˆ—è¡¨é¡¹é‡ç”¨è¯¥è§†å›¾ã€‚è¿™ç§é‡ç”¨å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œæ”¹å–„åº”ç”¨å“åº”èƒ½åŠ›å¹¶é™ä½åŠŸè€—ã€‚

### 1.2 RecyclerViewçš„ä¼˜ç‚¹

![android-working-with-recycler-view](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121425417.png)

RecyclerViewèƒ½å¤Ÿå®ç°ListIVewåˆ—è¡¨ï¼Œæ¨ªå‘æ»šåŠ¨çš„ListViewï¼Œ æ¨ªå‘æ»šåŠ¨çš„GridViewï¼Œç€‘å¸ƒæµæ§ä»¶ç­‰ï¼›

æ¯”å¦‚ï¼šæœ‰ä¸€ä¸ªéœ€æ±‚æ˜¯**å±å¹•ç«–ç€**çš„æ—¶å€™çš„æ˜¾ç¤ºå½¢å¼æ˜¯**ListView**ï¼Œå±å¹•**æ¨ªç€**çš„æ—¶å€™çš„æ˜¾ç¤ºå½¢å¼æ˜¯2åˆ—çš„**GridView**ï¼Œæ­¤æ—¶å¦‚æœç”¨**RecyclerView**ï¼Œåˆ™é€šè¿‡è®¾ç½®LayoutManager**ä¸€è¡Œä»£ç å®ç°æ›¿æ¢**ã€‚

RecylerViewç›¸å¯¹äºListViewçš„ä¼˜ç‚¹ç½—åˆ—å¦‚ä¸‹ï¼š

**1. RecyclerViewæ ‡å‡†åŒ–äº†ViewHolder**

RecyclerViewå°è£…äº†viewholderçš„å›æ”¶å¤ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¼–å†™Adapteré¢å‘çš„æ˜¯ViewHolderè€Œä¸å†æ˜¯Viewäº†ï¼Œå¤ç”¨çš„é€»è¾‘è¢«å°è£…äº†ï¼Œå†™èµ·æ¥æ›´åŠ ç®€å•ã€‚ç›´æ¥çœå»äº†listviewä¸­`convertView.setTag(holder)`å’Œ`convertView.getTag()`è¿™äº›ç¹ççš„æ­¥éª¤ã€‚

**2. æä¾›äº†ä¸€ç§æ’æ‹”å¼çš„ä½“éªŒ**ï¼Œ**é«˜åº¦çš„è§£è€¦**ï¼Œå¼‚å¸¸çš„çµæ´»ã€‚

é’ˆå¯¹ä¸€ä¸ªItemçš„æ˜¾ç¤ºRecyclerViewä¸“é—¨æŠ½å–å‡ºäº†ç›¸åº”çš„ç±»ï¼Œæ¥æ§åˆ¶Itemçš„æ˜¾ç¤ºï¼Œä½¿å…¶çš„æ‰©å±•æ€§éå¸¸å¼ºã€‚

**3. è®¾ç½®å¸ƒå±€ç®¡ç†å™¨ä»¥æ§åˆ¶Itemçš„å¸ƒå±€æ–¹å¼ï¼Œæ¨ªå‘ã€ç«–å‘ä»¥åŠç€‘å¸ƒæµæ–¹å¼**

ä¾‹å¦‚ï¼šä½ æƒ³æ§åˆ¶æ¨ªå‘æˆ–è€…çºµå‘æ»‘åŠ¨åˆ—è¡¨æ•ˆæœå¯ä»¥é€šè¿‡**LinearLayoutManager**è¿™ä¸ªç±»æ¥è¿›è¡Œæ§åˆ¶(ä¸GridViewæ•ˆæœå¯¹åº”GridLayoutManagerï¼Œä¸ç€‘å¸ƒæµå¯¹åº”çš„è¿˜StaggeredGridLayoutManagerç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´RecyclerViewä¸å†æ‹˜æ³¥äºListViewçš„çº¿æ€§å±•ç¤ºæ–¹å¼ï¼Œå®ƒä¹Ÿå¯ä»¥å®ç°GridViewçš„æ•ˆæœç­‰å¤šç§æ•ˆæœã€‚

**4.å¯è®¾ç½®Itemçš„é—´éš”æ ·å¼**ï¼ˆå¯ç»˜åˆ¶ï¼‰ã€‚

é€šè¿‡ç»§æ‰¿RecyclerViewçš„ItemDecorationè¿™ä¸ªç±»ï¼Œç„¶åé’ˆå¯¹è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚å»ä¹¦å†™ä»£ç ã€‚å¯ä»¥æ§Itemå¢åˆ çš„åŠ¨ç”»ï¼Œå¯ä»¥é€šè¿‡ItemAnimatorè¿™ä¸ªç±»è¿›è¡Œæ§åˆ¶ï¼Œå½“ç„¶é’ˆå¯¹å¢åˆ çš„åŠ¨ç”»ï¼ŒRecyclerViewæœ‰å…¶è‡ªå·±é»˜è®¤çš„å®ç°ã€‚

**ä½†æ˜¯å…³äºItemçš„ç‚¹å‡»å’Œé•¿æŒ‰äº‹ä»¶ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±å»å®ç°ã€‚**



## 2. RecyclerViewå·¥ä½œåŸç†ç®€ä»‹

> RecyclerViewæ¶‰åŠçš„å†…å®¹å¾ˆå¤šï¼Œæ­¤å¤„åŸç†åªæ˜¯ç®€å•ä»‹ç»å…¶å·¥ä½œåŸç†ï¼Œè¯¦æƒ…éƒ¨åˆ†åé¢ç« èŠ‚è¯¦ç»†è¯´æ˜

### 2.1 åŸç†ç®€ä»‹

RecyclerView æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒç”¨äºæ˜¾ç¤ºåˆ—è¡¨å½¢å¼ (list) ç½‘æ ¼å½¢å¼ (grid) çš„æ•°æ®æˆ–è€…ç€‘å¸ƒæµçš„æ•°æ®

å½“åˆ—è¡¨æ»‘åŠ¨çš„æ—¶å€™ï¼Œå®é™…ä¸Šåªæœ‰å°‘é‡é‚»è¿‘çš„è§†å›¾ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚å½“è§†å›¾æ»‘å‡ºå±å¹•æ—¶ï¼ŒRecyclerView ä¼šå¤ç”¨å®ƒå¹¶ä¸”å¡«å……æ–°çš„æ•°æ®ã€‚ç”±äºå®ƒæ˜¯é€šè¿‡**å›æ”¶å·²æœ‰çš„ç»“æ„**è€Œä¸æ˜¯æŒç»­åˆ›å»ºæ–°çš„åˆ—è¡¨é¡¹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æœ‰æ•ˆæé«˜åº”ç”¨çš„æ—¶é—´æ•ˆç‡å’Œç©ºé—´æ•ˆç‡ã€‚

![img](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121428921.png)

ç²‰çº¢è‰²çš„æ–¹æ ¼è¡¨ç¤ºå±å¹•ä¸Šæ­£åœ¨æ˜¾ç¤ºçš„è¡¨é¡¹ï¼Œé»„è‰²çš„æ–¹æ ¼è¡¨ç¤ºå±å¹•å¯è§†èŒƒå›´ä¹‹å¤–çš„è¡¨é¡¹æ˜¯å¦‚ä½•è¢«å›æ”¶å¹¶è½¬ä¸ºæ–°çš„è§†å›¾ã€‚RecyclerView ä½¿ç”¨ ViewHolder æ¨¡å¼ï¼Œè¿™æ ·åšå¯ä»¥æé«˜æ€§èƒ½ï¼Œå› ä¸ºå®ƒæ— éœ€é¢‘ç¹è°ƒç”¨ `findViewById()` æ–¹æ³•å³å¯è®¿é—®è¡¨é¡¹çš„è§†å›¾ï¼ŒListViewä¹Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹

![4h2wjwo0dlzkenw9ewnm](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121431700.png)

###  2.2 Adapter ç±»

æ¥ä¸‹æ¥æ˜¯ `RecyclerView` çš„é‡å¤´æˆäº†ï¼Œä¹Ÿå°±æ˜¯ [ViewHolder](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.ViewHolder) å’Œ [Adapter](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.Adapter) ç±»ã€‚

ViewHolder è´Ÿè´£å­˜å‚¨ RecyclerView ä¸­æ¯ä¸€ä¸ªå•ç‹¬çš„è¡¨é¡¹æ‰€éœ€è¦æ˜¾ç¤ºçš„ä¿¡æ¯ã€‚RecyclerView ä»…éœ€è¦åˆ›å»ºå½“å‰æ‰€æ˜¾ç¤ºçš„è¡¨é¡¹æ•°é‡çš„ ViewHolder å¤–åŠ ç¼“å­˜ä¸­çš„å‡ ä¸ª ViewHolder å³å¯ã€‚éšç€ç”¨æˆ·æ»‘åŠ¨å±å¹•ï¼ŒViewHolderä¼šè¢«å›æ”¶ (ä½¿ç”¨æ–°æ•°æ®è¿›è¡Œå¡«å……)ï¼Œå·²æœ‰çš„è¡¨é¡¹ä¼šåœ¨ä¸€ç«¯æ¶ˆå¤±ï¼Œå¹¶ä¸”åœ¨å¦ä¸€ç«¯æ˜¾ç¤ºä¸€ä¸ªæ–°çš„è¡¨é¡¹ã€‚

**ViewHolderä¸item Viewæ˜¯ä¸€ä¸€å¯¹åº”å…³ç³»**

![image-20220327215903618](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203272159821.png)

- **onCreateViewHolder**æ–¹æ³•å°±æ˜¯ç”¨æ¥åˆ›å»ºæ–°View;
- **getItemViewType**æ–¹æ³•æ˜¯å¯ä»¥æ ¹æ®ä¸åŒçš„*position*å¯ä»¥è¿”å›ä¸åŒçš„ç±»å‹;
- **onBindViewHolder**æ˜¯å°†æ•°æ®ä¸è§†å›¾ç»‘å®š;
- **getItemCount**æ–¹æ³•å°±æ˜¯è·å¾—éœ€è¦æ˜¾ç¤ºæ•°æ®çš„æ€»æ•°ã€‚

Adapter ç±»ä»æ•°æ®æºè·å¾—æ•°æ®ï¼Œå¹¶ä¸”å°†æ•°æ®ä¼ é€’ç»™æ­£åœ¨æ›´æ–°å…¶æ‰€æŒè§†å›¾çš„ ViewHolderã€‚

![img](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121434953.png)

å¦‚å›¾æ˜¾ç¤ºäº† RecyclerViewã€Adapterã€ViewHolder å’Œæ•°æ®ä¹‹é—´çš„åä½œå…³ç³»ã€‚

> [Adapterã€ViewHolderå®šä¹‰è¯¦è§£](https://www.iqqcode.top/pages/04bab7/)

### 2.3 å®˜æ–¹ä½¿ç”¨æ–‡æ¡£

#### å®˜æ–¹å…³é”®ç±»è§£é‡Š

> [https://developer.android.google.cn/guide/topics/ui/layout/recyclerview?hl=zh-cn](https://developer.android.google.cn/guide/topics/ui/layout/recyclerview?hl=zh-cn)

å°†å¤šä¸ªä¸åŒçš„ç±»æ­é…ä½¿ç”¨ï¼Œå¯æ„å»ºåŠ¨æ€åˆ—è¡¨ã€‚

- **[`RecyclerView`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView?hl=zh-cn)** æ˜¯åŒ…å«ä¸æ‚¨çš„æ•°æ®å¯¹åº”çš„è§†å›¾çš„ [`ViewGroup`](https://developer.android.google.cn/reference/android/view/ViewGroup?hl=zh-cn)ã€‚å®ƒæœ¬èº«å°±æ˜¯è§†å›¾ï¼Œå› æ­¤ï¼Œå°† `RecyclerView` æ·»åŠ åˆ°å¸ƒå±€ä¸­çš„æ–¹å¼ä¸æ·»åŠ ä»»ä½•å…¶ä»–ç•Œé¢å…ƒç´ ç›¸åŒï¼ˆxmlæ·»åŠ RecyclerViewä¸æ·»åŠ å…¶ä»–æ§ä»¶æ–¹å¼ä¸€æ ·ï¼‰
- åˆ—è¡¨ä¸­çš„æ¯ä¸ªç‹¬ç«‹å…ƒç´ éƒ½ç”±ä¸€ä¸ª ViewHolder å¯¹è±¡è¿›è¡Œå®šä¹‰ã€‚åˆ›å»º ViewHolder æ—¶ï¼Œå®ƒå¹¶æ²¡æœ‰ä»»ä½•å…³è”çš„æ•°æ®ã€‚åˆ›å»º ViewHolder åï¼Œ`RecyclerView` ä¼šå°†å…¶ç»‘å®šåˆ°å…¶æ•°æ®ã€‚æ‚¨å¯ä»¥é€šè¿‡æ‰©å±• [`RecyclerView.ViewHolder`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.ViewHolder?hl=zh-cn) æ¥å®šä¹‰ ViewHolderã€‚
- `RecyclerView` ä¼šè¯·æ±‚è¿™äº›è§†å›¾ï¼Œå¹¶é€šè¿‡åœ¨ Adapter ä¸­è°ƒç”¨æ–¹æ³•ï¼Œå°†è§†å›¾ç»‘å®šåˆ°å…¶æ•°æ®ã€‚æ‚¨å¯ä»¥é€šè¿‡æ‰©å±• [`RecyclerView.Adapter`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.Adapter?hl=zh-cn) æ¥å®šä¹‰ Adapterã€‚
- å¸ƒå±€ç®¡ç†å™¨è´Ÿè´£æ’åˆ—åˆ—è¡¨ä¸­çš„å„ä¸ªå…ƒç´ ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ RecyclerView åº“æä¾›çš„æŸä¸ªå¸ƒå±€ç®¡ç†å™¨ï¼Œä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„å¸ƒå±€ç®¡ç†å™¨ã€‚å¸ƒå±€ç®¡ç†å™¨å‡åŸºäºåº“çš„ [`LayoutManager`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.LayoutManager?hl=zh-cn) æŠ½è±¡ç±»ã€‚

æ€»ç»“æ¥å°±æ˜¯ï¼Œä½¿ç”¨RecyclerViewæ—¶ï¼Œéœ€è¦åœ¨XMLå¸ƒå±€ä¸­æ·»åŠ æ§ä»¶ã€å†å®šä¹‰Adapterå’ŒViewHolderï¼Œåœ¨åé€šè¿‡å¸ƒå±€ç®¡ç†å™¨æ¥ç®¡ç†æ˜¾ç¤ºçš„å…ƒç´ ã€‚

<br>

## 3. RecyclerViewçš„ä½¿ç”¨

### 3.1 è§„åˆ’å¸ƒå±€

RecyclerView ä¸­çš„åˆ—è¡¨é¡¹ç”± [`LayoutManager`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.LayoutManager?hl=zh-cn) ç±»è´Ÿè´£æ’åˆ—ã€‚RecyclerView åº“æä¾›äº†ä¸‰ç§å¸ƒå±€ç®¡ç†å™¨ï¼Œç”¨äºå¤„ç†æœ€å¸¸è§çš„å¸ƒå±€æƒ…å†µï¼š

- [`LinearLayoutManager`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/LinearLayoutManager?hl=zh-cn) å°†å„ä¸ªé¡¹æ’åˆ—åœ¨ä¸€ç»´åˆ—è¡¨ä¸­ã€‚
- `GridLayoutManager`å°†æ‰€æœ‰é¡¹æ’åˆ—åœ¨äºŒç»´ç½‘æ ¼ä¸­ï¼š
    - å¦‚æœç½‘æ ¼å‚ç›´æ’åˆ—ï¼Œ`GridLayoutManager` ä¼šå°½é‡ä½¿æ¯è¡Œä¸­æ‰€æœ‰å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ç›¸åŒï¼Œä½†ä¸åŒçš„**è¡Œ**å¯ä»¥æœ‰ä¸åŒçš„é«˜åº¦ã€‚
    - å¦‚æœç½‘æ ¼æ°´å¹³æ’åˆ—ï¼Œ`GridLayoutManager` ä¼šå°½é‡ä½¿æ¯åˆ—ä¸­æ‰€æœ‰å…ƒç´ çš„å®½åº¦å’Œé«˜åº¦ç›¸åŒï¼Œä½†ä¸åŒçš„**åˆ—**å¯ä»¥æœ‰ä¸åŒçš„å®½åº¦ã€‚
- [`StaggeredGridLayoutManager`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/StaggeredGridLayoutManager?hl=zh-cn) ä¸ `GridLayoutManager` ç±»ä¼¼ï¼Œä½†ä¸è¦æ±‚åŒä¸€è¡Œä¸­çš„åˆ—è¡¨é¡¹å…·æœ‰ç›¸åŒçš„é«˜åº¦ï¼ˆå‚ç›´ç½‘æ ¼æœ‰æ­¤è¦æ±‚ï¼‰æˆ–åŒä¸€åˆ—ä¸­çš„åˆ—è¡¨é¡¹å…·æœ‰ç›¸åŒçš„å®½åº¦ï¼ˆæ°´å¹³ç½‘æ ¼æœ‰æ­¤è¦æ±‚ï¼‰ã€‚å…¶ç»“æœæ˜¯ï¼ŒåŒä¸€è¡Œæˆ–åŒä¸€åˆ—ä¸­çš„åˆ—è¡¨é¡¹å¯èƒ½ä¼šé”™è½ä¸é½ã€‚

### 3.2 å®ç° Adapter å’Œ ViewHolder

ç¡®å®šå¸ƒå±€åï¼Œéœ€è¦å®ç° `Adapter` å’Œ `ViewHolder`ã€‚è¿™ä¸¤ä¸ªç±»é…åˆä½¿ç”¨ï¼Œå…±åŒå®šä¹‰æ•°æ®çš„æ˜¾ç¤ºæ–¹å¼ã€‚

`ViewHolder` æ˜¯åŒ…å«åˆ—è¡¨ä¸­å„åˆ—è¡¨é¡¹çš„å¸ƒå±€çš„ `View` çš„å°è£…å®¹å™¨ã€‚

`Adapter` ä¼šæ ¹æ®éœ€è¦åˆ›å»º `ViewHolder` å¯¹è±¡ï¼Œè¿˜ä¼šä¸ºè¿™äº›è§†å›¾è®¾ç½®æ•°æ®ã€‚å°†è§†å›¾ä¸å…¶æ•°æ®ç›¸å…³è”çš„è¿‡ç¨‹ç§°ä¸ºâ€œç»‘å®šâ€ã€‚

å®šä¹‰ Adapter æ—¶ï¼Œæ‚¨éœ€è¦æ›¿æ¢ä¸‰ä¸ªå…³é”®æ–¹æ³•ï¼š

- [`onCreateViewHolder()`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.Adapter?hl=zh-cn#onCreateViewHolder(android.view.ViewGroup, int))ï¼šæ¯å½“ `RecyclerView` éœ€è¦åˆ›å»ºæ–°çš„ `ViewHolder` æ—¶ï¼Œå®ƒéƒ½ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚æ­¤æ–¹æ³•ä¼šåˆ›å»ºå¹¶åˆå§‹åŒ– `ViewHolder` åŠå…¶å…³è”çš„ `View`ï¼Œä½†ä¸ä¼šå¡«å……è§†å›¾çš„å†…å®¹ï¼Œå› ä¸º `ViewHolder` æ­¤æ—¶å°šæœªç»‘å®šåˆ°å…·ä½“æ•°æ®ã€‚
- [`onBindViewHolder()`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.Adapter?hl=zh-cn#onBindViewHolder(VH, int))ï¼š`RecyclerView` è°ƒç”¨æ­¤æ–¹æ³•å°† `ViewHolder` ä¸æ•°æ®ç›¸å…³è”ã€‚æ­¤æ–¹æ³•ä¼šæå–é€‚å½“çš„æ•°æ®ï¼Œå¹¶ä½¿ç”¨è¯¥æ•°æ®å¡«å…… ViewHolder çš„å¸ƒå±€ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ `RecyclerView` æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªåç§°åˆ—è¡¨ï¼Œè¯¥æ–¹æ³•å¯èƒ½ä¼šåœ¨åˆ—è¡¨ä¸­æŸ¥æ‰¾é€‚å½“çš„åç§°ï¼Œå¹¶å¡«å…… ViewHolder çš„ [`TextView`](https://developer.android.google.cn/reference/android/widget/TextView?hl=zh-cn) widgetã€‚
- [`getItemCount()`](https://developer.android.google.cn/reference/androidx/recyclerview/widget/RecyclerView.Adapter?hl=zh-cn#getItemCount())ï¼šRecyclerView è°ƒç”¨æ­¤æ–¹æ³•æ¥è·å–æ•°æ®é›†çš„å¤§å°ã€‚ä¾‹å¦‚ï¼Œåœ¨é€šè®¯ç°¿åº”ç”¨ä¸­ï¼Œè¿™å¯èƒ½æ˜¯åœ°å€æ€»æ•°ã€‚RecyclerView ä½¿ç”¨æ­¤æ–¹æ³•æ¥ç¡®å®šä»€ä¹ˆæ—¶å€™æ²¡æœ‰æ›´å¤šçš„åˆ—è¡¨é¡¹å¯ä»¥æ˜¾ç¤ºã€‚

åŸºæœ¬å®ç°å¦‚ä¸‹ï¼š

```java
mRecyclerView = (RecyclerView) findViewById(R.id.recyclerView);  
LinearLayoutManager layoutManager = new LinearLayoutManager(this );  
//è®¾ç½®å¸ƒå±€ç®¡ç†å™¨  
mRecyclerView.setLayoutManager(layoutManager);  
//è®¾ç½®ä¸ºå‚ç›´å¸ƒå±€ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„  
mRecyclerView.setOrientation(OrientationHelper. VERTICAL);  
//è®¾ç½®Adapter  
mRecyclerView.setAdapter(recycleAdapter);  
 //è®¾ç½®åˆ†éš”çº¿  
mRecyclerView.addItemDecoration( new DividerGridItemDecoration(this ));  
//è®¾ç½®å¢åŠ æˆ–åˆ é™¤æ¡ç›®çš„åŠ¨ç”»  
mRecyclerView.setItemAnimator( new DefaultItemAnimator());  
```

åœ¨ä½¿ç”¨RecyclerViewæ—¶å€™ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªé€‚é…å™¨Adapterå’Œä¸€ä¸ªå¸ƒå±€ç®¡ç†å™¨LayoutManagerã€‚é€‚é…å™¨ç»§æ‰¿**`RecyclerView.Adapter`**ç±»ï¼Œå…·ä½“å®ç°ç±»ä¼¼ListViewçš„é€‚é…å™¨ï¼Œå–å†³äºæ•°æ®ä¿¡æ¯ä»¥åŠå±•ç¤ºçš„UIã€‚å¸ƒå±€ç®¡ç†å™¨ç”¨äºç¡®å®šRecyclerViewä¸­Itemçš„å±•ç¤ºæ–¹å¼ä»¥åŠå†³å®šä½•æ—¶å¤ç”¨å·²ç»ä¸å¯è§çš„Itemï¼Œé¿å…é‡å¤åˆ›å»ºä»¥åŠæ‰§è¡Œé«˜æˆæœ¬çš„`findViewById()`æ–¹æ³•ã€‚

> ä»¥ä¸Šå†…å®¹æ¥è‡ªå®˜æ–¹æ–‡æ¡£ï¼šhttps://developer.android.google.cn/guide/topics/ui/layout/recyclerview?hl=zh-cn

## 4. å®ç°åŸºç¡€åˆ—è¡¨

æˆ‘ä»¬å®ç°å¦‚ä¸‹æœ€åŸºæœ¬çš„Demoï¼Œç›´æ¥ä½¿ç”¨androidxåº“ï¼Œä¸éœ€è¦åšé¢å¤–æ·»åŠ ä¾èµ–

> [ğŸ”—Demoåœ°å€-https://github.com/IQQcode/MobileCoding/tree/main/Android-Core/03-Components/RecyclerView/RecyclerViewBaseUse](https://github.com/IQQcode/MobileCoding/tree/main/Android-Core/03-Components/RecyclerView/RecyclerViewBaseUse)

![recyclerBase](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121205666.gif)



### 4.1 å¸ƒå±€å†…å®¹

**ä¸»å¸ƒå±€æ–‡ä»¶activity_main**

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity">

    <TextView
        android:id="@+id/tv_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:layout_marginTop="10dp"
        android:text="RecyclerView"
        android:textSize="30sp"
        android:textStyle="bold" />

    <androidx.recyclerview.widget.RecyclerView
        android:id="@+id/recycler_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="#ced6e0" />

</LinearLayout>
```

**itemå¸ƒå±€æ–‡ä»¶item_view**

![image-20220312161536474](https://iqqcode-blog.oss-cn-beijing.aliyuncs.com/img-2021-later/202203121615622.png)

```xml
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <androidx.cardview.widget.CardView
        android:layout_width="match_parent"
        android:layout_height="110dp"
        android:background="#FFFFFF"
        app:cardUseCompatPadding="true">

        <RelativeLayout
            android:layout_width="match_parent"
            android:layout_height="100dp"
            android:layout_gravity="center_vertical">

            <ImageView
                android:id="@+id/itemImage"
                android:layout_width="90dp"
                android:layout_height="90dp"
                android:layout_centerVertical="true"
                android:layout_margin="1dp"
                android:scaleType="fitXY"
                android:src="@mipmap/ic_launcher" />

            <TextView
                android:id="@+id/itemContent"
                android:layout_width="match_parent"
                android:layout_height="120dp"
                android:layout_marginLeft="10dp"
                android:layout_toRightOf="@id/itemImage"
                android:gravity="center_vertical"
                android:text="test"
                android:textSize="20sp" />
        </RelativeLayout>

    </androidx.cardview.widget.CardView>

</RelativeLayout>
```

### 4.2 ViewHolder itemä¸­çš„æ§ä»¶

åˆ›å»ºä¸€ä¸ªå«åš CommonViewHolderçš„ç±»ï¼Œå¹¶ä¸”å®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ª itemView ä½œä¸ºå‚æ•°ã€‚åœ¨ ViewHolder ä¸­ï¼Œç”¨æ¥ç¼“å­˜itemä¸­çš„å­æ§ä»¶ï¼Œé¿å…ä¸å¿…è¦çš„findViewById

```java
public class CommonViewHolder extends RecyclerView.ViewHolder {

    ImageView imageView;
    TextView textView;

    public CommonViewHolder(@NonNull View itemView) {
        super(itemView);
        imageView = itemView.findViewById(R.id.itemImage);
        textView = itemView.findViewById(R.id.itemContent);
    }
}
```

### 4.3 Adapter

Adapteræ¥å†³å®šæ¯ä¸ªitemæ˜¾ç¤ºä»€ä¹ˆå†…å®¹ã€itemç›¸å…³çš„é€»è¾‘éƒ½åœ¨Adapterä¸­å®ç°

åˆ›å»ºCommonAdapterï¼Œç»§æ‰¿ `RecyclerView.Adapter`ï¼Œéœ€è¦é‡å†™ä¸‰ä¸ªæ–¹æ³• `onCreateViewHolder()`ã€`onBindViewHolder()` å’Œ `getItemCount()`

**é‡å†™ onCreateViewHolder()**

å½“ `ViewHolder` åˆ›å»ºçš„æ—¶å€™ä¼šè°ƒç”¨è¯¥æ–¹æ³•ã€‚åœ¨è¯¥æ–¹æ³•é‡Œè¿›è¡Œåˆå§‹åŒ–å’Œå¡«å…… `RecyclerView` ä¸­çš„è¡¨é¡¹è§†å›¾ã€‚è¯¥è§†å›¾ä½¿ç”¨å‰é¢æˆ‘ä»¬åˆ›å»ºçš„ç”¨äºæ˜¾ç¤ºæ–‡æœ¬çš„å¸ƒå±€ã€‚

```java
@NonNull
@Override
public CommonViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
    View view = inflater.inflate(R.layout.list_item_view, null);
    CommonViewHolder holder = new CommonViewHolder(view);
    return holder;  // ä¼ å…¥çš„Viewå°±æ˜¯æ¡ç›®ç•Œé¢
}
```

**é‡å†™ onBindViewHolder()**

`onBindViewHolder()` è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šä¼ å…¥å‚æ•° `ViewHolder` å’Œä¸€ä¸ªä½ç½® (position)ï¼Œå®ƒè¡¨ç¤ºåœ¨ List ä¸­æ‰€ç»‘å®šçš„è¡¨é¡¹çš„ä½ç½®ã€‚è¯¥ä½ç½®å¯ä»¥ç”¨äºæå–è¡¨é¡¹æ‰€éœ€çš„æ•°æ®ï¼Œå¹¶ä¸”å°†æ•°æ®ä¼ é€’ç»™ ViewHolder æ¥ä½¿æ•°æ®ç»‘å®šåˆ°å¯¹åº”çš„ UIã€‚

```java
@Override
public void onBindViewHolder(@NonNull CommonViewHolder holder, int position) {
    ItemData itemData = mList.get(position);
    holder.imageView.setImageResource(itemData.getImageId());
    holder.textView.setText(itemData.getName());
}
```

**é‡å†™ getItemCount()**

RecyclerView æ˜¾ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥å®ƒéœ€è¦çŸ¥é“åˆ—è¡¨é‡Œå…±æœ‰å¤šå°‘é¡¹ã€‚ç”±äºList å°±æ˜¯æ•°æ®æºï¼Œæ‰€ä»¥ç›´æ¥è¿”å›å®ƒçš„é•¿åº¦å³å¯ã€‚

```java
@Override
public int getItemCount() {
    return mList == null ? 0 : mList.size();
}
```

**å®Œæ•´Adapterä»£ç ï¼ŒåŒ…å«itemçš„ç‚¹å‡»äº‹ä»¶**

> itemç‚¹å‡»äº‹ä»¶å®ç°å‚è€ƒï¼š[ğŸ¨]()

```java
public class CommonAdapter extends RecyclerView.Adapter<CommonViewHolder> {

    private Context mContext;
    private List<ItemData> mList;
    private LayoutInflater inflater;
    private OnItemClickListener onClickListener;

    // åˆå§‹åŒ–Data
    public CommonAdapter(Context context) {
        mContext = context;
        inflater = LayoutInflater.from(context);
    }

    public void setData(List<ItemData> list) {
        this.mList = list;
    }

    public void setOnItemClickListener(OnItemClickListener clickListener) {
        this.onClickListener = clickListener;
    }

    /**
     * åˆ›å»ºViewHolderå®ä¾‹
     * @param parent
     * @param viewType
     * @return
     */
    @NonNull
    @Override
    public CommonViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
        View view = inflater.inflate(R.layout.list_item_view, null);
        CommonViewHolder holder = new CommonViewHolder(view);
        return holder;  // ä¼ å…¥çš„Viewå°±æ˜¯æ¡ç›®ç•Œé¢
    }

    /**
     * å¯¹RecyclerViewå­é¡¹çš„æ•°æ®è¿›è¡Œèµ‹å€¼çš„ï¼Œä¼šåœ¨æ¯ä¸ªå­é¡¹è¢«æ»šåŠ¨åˆ°å±å¹•å†…çš„æ—¶å€™æ‰§è¡Œ
     * @param holder
     * @param position
     */
    @Override
    public void onBindViewHolder(@NonNull CommonViewHolder holder, int position) {
        ItemData itemData = mList.get(position);
        holder.imageView.setImageResource(itemData.getImageId());
        holder.textView.setText(itemData.getName());
        holder.itemView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Toast.makeText(mContext, "item click", Toast.LENGTH_SHORT).show();
                onClickListener.onItemClick(holder.getAdapterPosition());
            }
        });
    }

    /**
     * itemæ¡ç›®ä¸ªæ•°
     * @return
     */
    @Override
    public int getItemCount() {
        return mList == null ? 0 : mList.size();
    }

    public interface OnItemClickListener {
        void onItemClick(int position);
    }
}
```

### 4.4 MainActivity

**ä¸ºitemæ„é€ æ•°æ®æº**

å®šä¹‰ä¸€ä¸ªå®ä½“ç±»ï¼Œæ¥æ‰¿è½½æ•°æ®

```java
public class ItemData {
    private String name;
    protected int imageId;

    public ItemData() { }

    public ItemData(String name, int imageId) {
        this.name = name;
        this.imageId = imageId;
    }

    public String getName() {
        return name;
    }

    public int getImageId() {
        return imageId;
    }
}
```

**MainActivityçš„é€»è¾‘**

```java
/**
 * @Author: iqqcode
 * @Date: 2022/3/5
 * @Description: RecyclerViewä¸Šæ‰‹ä½¿ç”¨
 */
public class MainActivity extends AppCompatActivity {

    private RecyclerView mRecyclerView;
    private CommonAdapter mAdapter;
    private List<ItemData> dataList = new ArrayList<>();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        initView();
        initData();

        LinearLayoutManager layoutManager = new LinearLayoutManager(this);
        mRecyclerView.setLayoutManager(layoutManager);
        mAdapter = new CommonAdapter(this);
        mAdapter.setData(dataList); // ç”¨setæ–¹æ³•æˆ–è€…æ„é€ éƒ½å¯ä»¥å°†dataListä¼ å…¥Adapterä¸­
        mRecyclerView.setAdapter(mAdapter);
        mAdapter.setOnItemClickListener(new CommonAdapter.OnItemClickListener() {
            @Override
            public void onItemClick(int position) {
                // ç‚¹å‡»itemæ˜¯ï¼Œå°†è¯¥itemçš„æ•°æ®ä¼ é€’åˆ°è·³è½¬çš„NewActivityå¤„
                Intent intent = new Intent(MainActivity.this, NewActivity.class);
                intent.putExtra("itemName", dataList.get(position).getName());
                startActivity(intent);
            }
        });
    }

    private void initView() {
        mRecyclerView = findViewById(R.id.recycler_view);
    }

    private void initData() {
        for (int i = 0; i < 3; i++) {
            ItemData apple = new ItemData("Apple", R.mipmap.ic_launcher);
            dataList.add(apple);
            ItemData banana = new ItemData("Banana", R.mipmap.ic_launcher);
            dataList.add(banana);
            ItemData orange = new ItemData("Orange", R.mipmap.ic_launcher);
            dataList.add(orange);
            ItemData watermelon = new ItemData("Watermelon", R.mipmap.ic_launcher);
            dataList.add(watermelon);
            ItemData pear = new ItemData("Pear", R.mipmap.ic_launcher);
            dataList.add(pear);
            ItemData grape = new ItemData("Grape", R.mipmap.ic_launcher);
            dataList.add(grape);
            ItemData pineapple = new ItemData("Pineapple", R.mipmap.ic_launcher);
            dataList.add(pineapple);
            ItemData strawberry = new ItemData("Strawberry", R.mipmap.ic_launcher);
            dataList.add(strawberry);
            ItemData cherry = new ItemData("Cherry", R.mipmap.ic_launcher);
            dataList.add(cherry);
            ItemData mango = new ItemData("Mango", R.mipmap.ic_launcher);
            dataList.add(mango);
        }
    }
}
```

**NewActivityè·³è½¬åˆ°çš„æ–°Activity**

```java
public class NewActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_new);

        Intent intent = getIntent();
        String itemName = intent.getStringExtra("itemName");
        TextView textView = findViewById(R.id.activityText);
        textView.setText(itemName);
    }
}
```





